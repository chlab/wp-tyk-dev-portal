NameVirtualHost *:80

<VirtualHost *:80>
  ServerName ogdch.dev

  ## Vhost docroot
  DocumentRoot "/var/www/ogdch.dev"

  ScriptAlias /cgi-bin/ "/var/www/cgi-bin/"
  <Directory "/var/www/ogdch.dev">
    Options +Indexes FollowSymLinks +ExecCGI
    AddHandler php5-fastcgi .php
    Action php5-fastcgi /cgi-bin/php.fastcgi
    AllowOverride All
    Order allow,deny
    Allow from All
  </Directory>

  ## Logging
  ErrorLog "/var/log/httpd/wp_error.log"
  ServerSignature Off
  CustomLog "/var/log/httpd/wp_access.log" combined

  ## SetEnv/SetEnvIf for environment variables
  SetEnv APP_ENV dev
</VirtualHost>

User vagrant
Group vagrant

NameVirtualHost *:8080

WSGISocketPrefix /var/run/wsgi
<VirtualHost *:8080>

    ServerName <%= node[:host_name]  %>
    ServerAlias ckan.<%= node[:host_name]  %>
    UseCanonicalName Off
    
    WSGIScriptAlias / /etc/ckan/default/apache.wsgi

    # pass authorization info on (needed for rest api)
    WSGIPassAuthorization On

    # Deploy as a daemon (avoids conflicts between CKAN instances)
    WSGIDaemonProcess ckan_default display-name=ckan_default processes=2 threads=15

    WSGIProcessGroup ckan_default

    ErrorLog /var/log/httpd/ckan_default.error.log
    CustomLog /var/log/httpd/ckan_default.custom.log combined

</VirtualHost>
